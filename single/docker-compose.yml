version: "3.7"
services:
  node1:
    image: nutsfoundation/nuts-node:local
    environment:
      NUTS_CONFIGFILE: /opt/nuts/nuts.yaml
      NUTS_NETWORK_BOOTSTRAPNODES: node2:5555, node3:5555, node4:5555, node5:5555
    ports:
      - "1001:1323"
    healthcheck:
      test: "curl -f http://127.0.0.1:1323/status || exit 1"
    volumes:
      - "./config/node/nuts1.yaml:/opt/nuts/nuts.yaml"
      - "./data/node1:/opt/nuts/data"
  node2:
    image: nutsfoundation/nuts-node:local
    environment:
      NUTS_CONFIGFILE: /opt/nuts/nuts.yaml
      NUTS_NETWORK_BOOTSTRAPNODES: node1:5555, node3:5555, node4:5555, node5:5555
    ports:
      - "1002:1323"
    healthcheck:
      test: "curl -f http://127.0.0.1:1323/status || exit 1"
    volumes:
      - "./config/node/nuts2.yaml:/opt/nuts/nuts.yaml"
      - "./data/node2:/opt/nuts/data"
  node3:
    image: nutsfoundation/nuts-node:local
    environment:
      NUTS_CONFIGFILE: /opt/nuts/nuts.yaml
      NUTS_NETWORK_BOOTSTRAPNODES: node1:5555, node2:5555, node4:5555, node5:5555
    ports:
      - "1003:1323"
    healthcheck:
      test: "curl -f http://127.0.0.1:1323/status || exit 1"
    volumes:
      - "./config/node/nuts3.yaml:/opt/nuts/nuts.yaml"
      - "./data/node3:/opt/nuts/data"
  node4:
    image: nutsfoundation/nuts-node:local
    environment:
      NUTS_CONFIGFILE: /opt/nuts/nuts.yaml
      NUTS_NETWORK_BOOTSTRAPNODES: node1:5555, node2:5555, node3:5555, node5:5555
    ports:
      - "1004:1323"
    healthcheck:
      test: "curl -f http://127.0.0.1:1323/status || exit 1"
    volumes:
      - "./config/node/nuts4.yaml:/opt/nuts/nuts.yaml"
      - "./data/node4:/opt/nuts/data"
  node5:
    image: nutsfoundation/nuts-node:local
    environment:
      NUTS_CONFIGFILE: /opt/nuts/nuts.yaml
      NUTS_NETWORK_BOOTSTRAPNODES: node1:5555, node2:5555, node3:5555, node4:5555
    ports:
      - "1005:1323"
    healthcheck:
      test: "curl -f http://127.0.0.1:1323/status || exit 1"
    volumes:
      - "./config/node/nuts5.yaml:/opt/nuts/nuts.yaml"
      - "./data/node5:/opt/nuts/data"
  explorer:
    image:  reinkrul/nuts-explorer:latest
    environment:
      NUTS_NODE_ADDRESS: http://node1:1323
    ports:
      - "8080:8080"
